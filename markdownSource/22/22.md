皆さんはNTFS圧縮をご存じですか？NTFS圧縮は名前の通り圧縮機能なのですが、zipファイルなどにしなくとも容量を削減できる優れモノです。しかし、良いことだらけではなく、デメリットなどもあるため、今回はそれらについて解説していきます。

## NTFS圧縮
NTFS圧縮はzip等と同様の「可逆圧縮/無損失圧縮」です。ただし、アルゴリズム(仕様)が異なるためzipより圧縮効率は控えめです。

しかし、NTFS圧縮最大のメリットは「圧縮されていないかのように操作が出来る」ということです。例えば、zipファイルでは「展開」をするまで操作できませんが、NTFS圧縮は「そのまま」で操作できます。１つ１つの手間がないのにもかかわらず、容量を大きく空けることができるのが特徴です。

## メリット
NTFS圧縮のメリットはなんといっても容量の節約です。32GBのUSBに一杯いっぱいデータを保存しても、NTFS圧縮を施すことで、通常500MB～2GBの空き容量が出来ます。

さらに、このNTFS圧縮はデータが多くなればなるほどデータの圧縮率もあがります。それはNTFS圧縮のアルゴリズムに起因します。500GBのストレージであれば平均20GBの書き込みが可能で、3000GB(3TB)のストレージであれば、300GB以上書き込み量が増えます。筆者の環境では2000GBの物理データが1742GBに圧縮、258GBも追加で書き込めているので、効果は大きいと思われます。

メリットはこれだけでは止まらず、SSD等の環境では空き容量は多い方がパフォーマンスがあがったり、寿命が延びたりしますが、このNTFS圧縮を行うことで、空き容量による長寿命化も可能です。

上記のメリットは極端な運用をしない限り、全て得ることが可能です。使ってみてもよいかもしれません。しかし、場合によってはデメリットに遭遇するかもしれません。それも解説していきます。

## デメリット
NTFSのデメリットの最も大きいものは、速度が低下するか、CPU使用率が上がることです。NTFS圧縮は「圧縮処理」をしているため、負荷がかかります。それにより読み書き速度が落ちる可能性があります。読み込みは極端に下がることは稀ですが、書き込み速度は極めて下がりやすいです。

次に、ファイルの断片化というのが起こることがあります。決してファイルが壊れるわけではありません。断片化とは、物理ストレージ上で記録されているファイルの場所がまばらになることで、読み込みの効率が下がる現象です。さらに、書き込みの際も所々に書き込まれるような状況に陥ります。その際に「デフラグ」または「最適化」という処理が必要です。これを行うことでパフォーマンスをぐっと上げることが可能ですが、とある状況下ではとんでもない時間を要することがあります。それは以下のタイミングです。
- ファイルを大量に移動した
- アプリケーションをNTFS圧縮が有効になっているディスクで行った
- 小さなファイルが多数ある
- 大容量のデータが蓄積している
- 空き容量が少ない

このタイミングでのデフラグは１日経っても終わらないことがほとんどです。筆者の環境で2TBのデータがあるディスクをデフラグした際には２日かかりました。そういったデメリットがありますが、筆者は容量を選び、運用を続けています。判断は自信で行いましょう。

## まとめ
NTFS圧縮は速度を犠牲に、大容量を提供する機能です。データを保管するだけであったり、小さなストレージしか持っていない環境などで運用を続ける方はおすすめします。
